# システム要件定義書

## 1. 外部システム連携要件

「極限まで入力を減らす」ため、アプリ本体を介さない外部インターフェースからのデータ受け入れを必須とする。

- **外部トリガー受け入れ：**
  - OS 標準のショートカット機能から「金額」および「カテゴリ」の引数を受け取り、バックグラウンドで処理を完結させる。
  - ホーム画面およびロック画面上のウィジェットからのタップ操作を即座にデータ処理へ反映させる。
- **バックグラウンド処理：**
  - アプリが非アクティブな状態でも、データの保存および集計値の更新が完了すること。

## 2. アプリケーション機能要件

### 2.1 支出管理エンジン

- **支出登録：** 金額・カテゴリ・日時の 3 点を保持。
- **カテゴリ管理：** ユーザーが迷わないよう、システム側で事前に定義された少数のカテゴリ（初期値 3〜4 つ）を管理。
- **履歴管理：** 登録データの閲覧、削除、および簡易編集機能。

### 2.2 予算・集計ロジック

- **予算設定：** 月単位の支出上限額を保持。
- **リアルタイム集計：**
  - 「当月の総支出額」の算出。
  - 「予算残高（予算額 - 総支出額）」の算出。
  - 「予算進捗率（総支出額 ÷ 予算額）」の算出。
- **期間自動更新：** 月が替わった際に、自動的に集計対象を当月に切り替える処理。

## 3. データ要件

- **データ構造：**
  - 支出レコード：ID、金額、カテゴリ、タイムスタンプ
  - 設定データ：月間予算額、カテゴリマスター
- **永続化仕様：**
  - 入力データは即座に永続化され、アプリ終了や再起動後も保持されること。
  - オフライン状態でも全ての機能が制限なく利用できること。

## 4. 非機能要件

- **パフォーマンス：**
  - 外部トリガーからのデータ保存は 1 秒以内に完了すること。
  - アプリ起動時、集計結果を待機時間なしで表示すること。
- **ユーザビリティ：**
  - 入力完了までのタップ数を最小化するための UI 制御（キーボード自動展開等）。
